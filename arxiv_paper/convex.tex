\section{Convex Hull}\label{sec:ch}
We first consider the \textit{convex hull
score}.  We briefly recall the definition of a convex set and then
define this score function.



\begin{definition}
	A set in $\R^2$ or $\mbb{S}^2$  is \textbf{convex} if every shortest geodesic segment between any two points in the set is entirely 
	contained within that set.
\end{definition}





\begin{definition}
  Let $\mathrm{conv}(\Omega)$ denote the \textit{convex hull} of
  a region $\Omega$ in either the sphere or the plane, which is the
  smallest convex region containing $\Omega$.  Then we define the
  \textit{convex hull score} of $\Omega$ as 
  \begin{align*}
    \mathrm{CH}(\Omega)=
    \frac{\mathrm{area}(\Omega)}{\mathrm{area}(\mathrm{conv}(\Omega)).}
  \end{align*}
  
  Since the intersection of convex sets is a convex set, there is a unique smallest (by containment) convex hull for any region $\Omega$.
\end{definition}



\begin{figure}[htb]
	\centering
	%\includegraphics[width=.35\textwidth]{figs/ch_example.png}
	\input{figs/ch_example}
	\caption{A region $\Omega$ and its convex hull.}
	\label{fig:ch_example}
\end{figure}

Suppose that our map projection $\vphi$ does  preserve the ordering of regions induced by the convex hull score.  We begin by observing that such a projection must preserve certain geometric properties of regions within its domain.
\begin{lemma}~\label{lem:CH_prep}
	Let $\vphi$ be a map projection from some region of the sphere to a region of the plane. If $\vphi$ preserves the convex hull compactness score ordering, then the following must 
	hold:
	\begin{enumerate}
		\item $\vphi$ and $\vphi^{-1}$ send convex regions in their domains to convex regions in their codomains.
		\item $\vphi$ sends every segment of a great circle in its domain to a line segment in its codomain.  That is, it preserves geodesics.\footnote{Such a projection is sometimes called a \textit{geodesic map}.}
		\item There exists a region $U$ in the domain of $\vphi$
		such that for any regions $A,B\subset U$, if 
		$A$ and $B$ have equal area on the sphere, then 
		$\vphi(A)$ and $\vphi(B)$ have equal area in the plane.  The same holds 
		for $\vphi^{-1}$ for all pairs of regions inside of $\vphi(U)$.
	\end{enumerate}
\end{lemma}


\ifsmallfigs
\else
\begin{figure}[h]
	\centering
	\begin{minipage}{.3\textwidth}
	\input{figs/ch_sphere_schema}
			\end{minipage}
	\begin{minipage}{.3\textwidth}
	\input{figs/ch_sphere_schema-x}
\end{minipage}
	\begin{minipage}{.3\textwidth}
	\input{figs/ch_sphere_schema-y}
\end{minipage}
	\caption{Two equal area regions $A$ and $B$ removed from $U$ to form the regions $X$ and $Y$.}
	\label{fig:ch_schema}
\end{figure}
\fi


\begin{proof}



		The proof of (1) follows from the idea that any projection which preserves the convex hull score ordering of regions must 
		preserve the maximizers in that ordering.   Here, the maximizers are convex sets.
		
		 Suppose, for the sake of contradiction, that there is some geodesic segment $s$ in $U$ such that $\vphi(s)$ is not a line segment. Construct two convex spherical polygons $L$ and $M$ inside of $U$ which both have $s$ as a side. 




\ifsmallfigs
\begin{figure}
	\centering
	\begin{minipage}{.5\textwidth}
		\centering
	\resizebox{.95\textwidth}{!}{\input{figs/ch_sphere_schema}}	
		\captionof{figure}{Two equal area regions $A$ and $B$\\ removed from $U$.}
	\label{fig:ch_schema}
	\end{minipage}%
	\begin{minipage}{.5\textwidth}
		\centering
		\resizebox{1.15\textwidth}{!}{\input{figs/nonconvex}}
\captionof{figure}{If $\vphi(s)$ is not a line segment,\\ then one of $\vphi(M)$ or $\vphi(L)$ is not convex.}
\label{fig:lineconvexcont}
	\end{minipage}
\end{figure}
\fi





		
\ifsmallfigs
\else		
\begin{figure}[h]
	\centering
	%\includegraphics[width=.25\textwidth]{figs/ch_sphere_schema.png}
	\input{figs/nonconvex}
	\caption{If $\vphi(s)$ is not a line segment, then one of $\vphi(M)$ or $\vphi(L)$ is not convex.}
	\label{fig:lineconvexcont}
\end{figure}
\fi
		 By (1), $\vphi$ must send both of these polygons to convex regions in the plane, but this is not the case.  All of the points along $\vphi(s)$ belong to both $\vphi(L)$ and $\vphi(M)$, but since $\vphi(s)$ is not a line segment, we can find two points along it which are joined by some line segment which contains points which only belong to $\vphi(L)$ or $\vphi(M)$, which means that at least one of these convex spherical polygons is sent to something non-convex in the plane, which contradicts our assumption.		See \Cref{fig:lineconvexcont} for an illustration.
		
		That $\vphi^{-1}$ sends line segments in the plane to great circle segments on the sphere is shown analogously.  
		This completes the proof of (2).
		
		
		
 To show (3), let $U$ be some convex region in the domain of $\vphi$.  Take $A,B$ to be regions of equal area such that $A$ and $B$ are properly contained in the interior of $U$, as in \Cref{fig:ch_schema}.  Define two new regions $X=U\ssm A$ and $Y=U\ssm B$, i.e. these regions are equal to $U$ with $A$ or $B$ deleted, respectively.  

The cap $U$ is itself the convex hull of both $X$ and $Y$, and since $A$ and $B$ have equal area, we have that $\mathrm{CH}(X) = \mathrm{CH}(Y)$.  Since $U$ is a cap, it is convex, so by (1), $\vphi(U)$ is also convex.  Since $\vphi$ preserves the ordering of convex hull scores and $X$ and $Y$ had equal scores on the sphere, $\vphi$ must send $X$ and $Y$ to regions in the plane which also have the same convex hull score as each other.  Furthermore, the convex hulls of $\vphi(X)$ and $\vphi(Y)$ are $\vphi(U)$.

By definition, we have
\begin{align*}
\mathrm{CH}(X) &= \mathrm{CH}(Y)\\
\end{align*}
and by the construction of $X$ and $Y$, we have 
\begin{align*}
\frac{\mathrm{area}(\vphi(U)) - \mathrm{area}(\vphi(A))}{\mathrm{area}(\vphi(U))} &= \frac{\mathrm{area}(\vphi(U)) - \mathrm{area}(\vphi(B))}{\mathrm{area}(\vphi(U))}\\
\mathrm{area}(\vphi(A)) &= \mathrm{area}(\vphi(B))
\end{align*}
 which is what we wanted to show.  The proof that $\vphi^{-1}$ also has this property is analogous.

\end{proof}

We can now show that no map projection can preserve the convex hull score ordering of regions by demonstrating that there is no projection from a patch on the sphere to the plane which has all three of the properties described  in \Cref{lem:CH_prep}. 


\begin{theorem}
	There does not exist a map projection with the three properties in Lemma~\ref{lem:CH_prep}
\end{theorem}
\begin{proof}
	Assume that such a map, $\vphi$, exists, and restrict 
	it to $U$ as above. Let $T\subset U$ be a 
	small equilateral spherical  triangle centered at 
	the center of $U$. Let $T_1$ and $T_2$ be two 
	congruent triangles meeting at a point and 
	each sharing a face with $T$, as in \Cref{fig:sphtris}.

\begin{figure}[!htb]
	\centering
	%\includegraphics[width=.25\textwidth]{figs/spheretri.png}
	\input{figs/spheretri}
	\caption{The spherical regions $T,T_1,T_2$.}
	\label{fig:sphtris}
\end{figure}












We first argue that the images of $T\cup T_1$ and $T\cup T_2$ are parallelograms.

Without loss of generality, consider $T\cup T_1$.  By construction, it is a 
convex spherical quadrilateral. By symmetry, its geodesic 
diagonals on the sphere divide it into four triangles of equal area.  To see this, consider the geodesic segment which passes through the vertex of $T$ opposite the side shared with $T_1$ which divides $T$ into two smaller triangles of equal area.  Since $T$ is equilateral, this segment meets the shared side at a right angle at the midpoint, and the same is true for the area bisector of $T_1$.  Since both of these bisectors meet the shared side at a right angle and at the same point, together they form a single geodesic segment, the diagonal of the quadrilateral.  Since the diagonal cuts each of $T$ and $T_1$ in half, and $T$ and $T_1$ have the same area, the four triangles formed in this construction have the same area.


		Since $\vphi$ sends spherical geodesics to line segments in the plane, it must send 
		$T\cup T_1$ to a Euclidean quadrilateral $Q$ whose diagonals 
		are the images of the diagonals of the spherical quadrilateral $T\cup T_1$.
		
		 Since 
		$\vphi$ sends equal area regions to equal area 
		regions, it follows that the diagonals 
		of $Q$ split it into four equal area triangles.
		
		We now argue that this implies that $Q$ is a Euclidean parallelogram by showing that its diagonals bisect each other.  Since the four triangles 
		formed by the diagonals of $Q$ are all the same area, we can pick two of these triangles which share a side 
		and consider the larger triangle formed by their union.  One side of this triangle is a diagonal $d_1$ of $Q$ and its area is 
		bisected by the other diagonal $d_2$, which passes through $d_1$ and its opposite vertex.  The area bisector from a vertex, called the \textit{median}, passes through the midpoint of the side $d_1$, meaning that the diagonal $d_2$ bisects the diagonal $d_1$.  Since this holds for any choice of two adjacent triangles in $Q$, the diagonals must bisect each other, so $Q$ is a parallelogram.
		
		\begin{figure}[h]
			\centering
			%\includegraphics[width=.25\textwidth]{figs/spheretri_plane.png}
			\input{figs/spheretri_plane}
			\caption{The image under $\vphi$ of $T,T_1,T_2$ which form the quadrilateral in the plane.}
			\label{fig:sphtris_pl}
		\end{figure}
		

Since $T\cup T_1$ and $T\cup T_2$ are both spherical quadrilaterals which overlap on the spherical triangle $T$, the images of $T\cup T_1$ and $T\cup T_2$ are Euclidean parallelograms of equal area which overlap on a shared triangle $\vphi(T)$. See \Cref{fig:sphtris_pl} for an illustration.
  
Because  the segment $\ell$ is parallel to $m_1$ and $m_2$, $m_1$ and $m_2$ are parallel to each other, and because they meet at the point shared by all three triangles, $m_1$ and $m_2$ together form a single segment parallel to $\ell$.  Therefore, the image of the three triangles forms a quadrilateral in the plane.
	Therefore, the image of $T\cup T_1\cup T_2$ has a boundary consisting of 
	four line segments.
	
	To find the contradiction, consider the point on the sphere shared by $T$, $T_1$, and $T_2$.  Since these triangles are all equilateral spherical triangles, the three angles at this point are each strictly greater than $\tfrac{\pi}{3}$ radians, because the sum of interior angles on a triangle is strictly greater than $\pi$.  
	so, the total measure of the three angles at this point is greater than $\pi$,  Therefore, the two geodesic segments which are part of the boundaries of $T_1$ and $T_2$ meet at this point at an angle of measure strictly greater than 
	$\pi$. Therefore, together they do not form a single geodesic.  On the sphere, the region $T\cup T_1\cup T_2$ has a boundary consisting of five geodesic segments whereas its image has a boundary consisting of four, which contradicts the assumption that $\vphi$ and $\vphi^{-1}$ preserve geodesics.
\end{proof}

This implies that no map projection can preserve the ordering of regions by their convex hull scores, which is what we aimed to show.

